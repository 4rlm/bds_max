<p id="notice"><%= notice %></p>

<h3 class="section-header">Geolocations - Nearby</h3>

<div class="pull-right">
    <%= link_to 'Back', locations_path, class: 'btn btn-primary' %>
    <%= link_to 'Edit', edit_location_path(@location), class: 'btn btn-primary' %>
    <%= link_to 'Download CSV', locations_path(format: "csv"), class: 'btn btn-primary' %>
</div> <br>


<table class="list-table table table-bordered table-hover text-nowrap table-striped">
    <thead>
        <tr>
            <th>Status</th>
            <th>Source</th>

            <th>Account Name</th>
            <th>Full Address</th>
            <th>Street</th>
            <th>City</th>
            <th>State</th>
            <th>Zip</th>
            <th>Latitude</th>
            <th>Longitude</th>
            <th>SFDC ID</th>

            <th>Created</th>
            <th>Updated</th>

        </tr>
    </thead>
    <tbody>
        <tr>
            <td><%= @location.location_status %></td>
            <td><%= @location.source %></td>
            <td><%= @location.acct_name %></td>
            <td><%= @location.address %></td>
            <td><%= @location.street %></td>
            <td><%= @location.city %></td>
            <td><%= @location.state_code %></td>
            <td><%= @location.postal_code %></td>
            <td><%= @location.latitude %></td>
            <td><%= @location.longitude %></td>
            <td><%= @location.sfdc_id %></td>

            <% if @location.created_at %>
                <td><%= @location.created_at.strftime("%m/%d/%Y") %></td>
            <% else %>
                <td><%= @location.created_at%></td>
            <% end %>

            <% if @location.updated_at %>
                <td><%= @location.updated_at.strftime("%m/%d/%Y") %></td>
            <% else %>
                <td><%= @location.updated_at%></td>
            <% end %>

        </tr>
    </tbody>
</table>

<table class="list-table table table-bordered table-hover text-nowrap table-striped">
    <thead>
        <tr>
            <th colspan="20">Nearby Locations</th>
        </tr>
        <tr>

            <th>#</th>
            <th>Status</th>
            <th>Source</th>

            <th>Account Name</th>
            <th>Full Address</th>
            <th>Street</th>
            <th>City</th>
            <th>State</th>
            <th>Zip</th>
            <th>Latitude</th>
            <th>Longitude</th>
            <th>Distance</th>
            <th>SFDC ID</th>

            <th>Created</th>
            <th>Updated</th>

        </tr>
    </thead>

    <tbody>
        <% num = 0 %>
        <% for location in @location.nearbys(5) %>
        <tr>
            <% num +=1 %>
            <td><%= num %></td>

            <td><%= location.location_status %></td>
            <td><%= location.source %></td>
            <td><%= link_to location.acct_name, location %></td>
            <td><%= link_to location.address, location %></td>
            <td><%= link_to location.street, location %></td>
            <td><%= location.city%></td>
            <td><%= location.state_code %></td>
            <td><%= location.postal_code %></td>
            <td><%= location.latitude %></td>
            <td><%= location.longitude %></td>
            <td><%= location.distance.round(2) %> (mi)</td>
            <td><%= location.sfdc_id %></td>

            <% if location.created_at %>
                <td><%= location.created_at.strftime("%m/%d/%Y") %></td>
            <% else %>
                <td><%= location.created_at%></td>
            <% end %>

            <% if location.updated_at %>
                <td><%= location.updated_at.strftime("%m/%d/%Y") %></td>
            <% else %>
                <td><%= location.updated_at%></td>
            <% end %>

            <% end %>
        </tr>

    </tbody>
</table>


<!-- Static Maps API Key: AIzaSyDLlXe8kdy8U5_ezK9c-r55-1TNquaECfw -->
<!-- Embeded Maps API Key: AIzaSyCMINjz6qATKxuxTc6tWNzyVehLybEYouY  -->
<!-- JS Map API Key:  AIzaSyD3RRIDYgdHCyp9q6rZnt_s3_JInTXph5o -->
<!-- Places API Key: AIzaSyCrUeAtqsGZGZ0kOFv6vkxcBYk_slCD2fI -->

<div class="geo-map-container">
    <div class="row">

        <div class="col-md-6">

        <%= image_tag "http://maps.google.com/maps/api/staticmap?size=500x500&sensor=false&zoom=17&markers=#{@location.latitude}%2C#{@location.longitude}&key=AIzaSyDLlXe8kdy8U5_ezK9c-r55-1TNquaECfw", :class => "geo-map-1" %>

        </div>
        <div class="col-md-6">

        <iframe width="500" height="500" frameborder="0" class="geo-map-2" src="https://www.google.com/maps/embed/v1/place?key=AIzaSyCMINjz6qATKxuxTc6tWNzyVehLybEYouY&zoom=17&q=<%= "#{@location.latitude}%2C#{@location.longitude}" %>"allowfullscreen>
        </iframe>

        </div>
    </div>
</div>


<%= image_tag "http://maps.google.com/maps/api/staticmap?size=500x500&sensor=false&zoom=17&markers=#{@location.latitude}%2C#{@location.longitude}&key=AIzaSyDLlXe8kdy8U5_ezK9c-r55-1TNquaECfw", :class => "geo-map-1" %>


<%= link_to "https://maps.googleapis.com/maps/api/place/nearbysearch/json?location=-33.8670522,151.1957362&radius=500&type=restaurant&keyword=cruise&key=AIzaSyCrUeAtqsGZGZ0kOFv6vkxcBYk_slCD2fI" %>
